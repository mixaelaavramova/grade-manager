<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CS50 –¢–µ—Å—Ç | NVNACS50</title>
  <link rel="stylesheet" href="../globals.css">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      margin: 0;
      padding: 20px;
    }

    .quiz-container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      overflow: hidden;
    }

    .quiz-header {
      background: #4a5568;
      color: white;
      padding: 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .timer {
      font-size: 24px;
      font-weight: bold;
      font-variant-numeric: tabular-nums;
    }

    .timer.warning {
      color: #fc8181;
      animation: pulse 1s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    .quiz-progress {
      padding: 16px 24px;
      background: #edf2f7;
      border-bottom: 2px solid #e2e8f0;
    }

    .keyboard-hint {
      background: #f0f4ff;
      color: #5a67d8;
      padding: 8px 16px;
      font-size: 13px;
      text-align: center;
      border-bottom: 1px solid #d6e0ff;
    }

    .keyboard-hint kbd {
      background: white;
      padding: 2px 6px;
      border-radius: 3px;
      border: 1px solid #cbd5e0;
      font-family: monospace;
      font-weight: bold;
      margin: 0 2px;
    }

    .progress-bar {
      background: #e2e8f0;
      height: 8px;
      border-radius: 4px;
      overflow: hidden;
      margin-top: 8px;
    }

    .progress-fill {
      background: linear-gradient(90deg, #667eea, #764ba2);
      height: 100%;
      transition: width 0.3s ease;
    }

    .quiz-content {
      padding: 32px;
    }

    .question-header {
      margin-bottom: 24px;
    }

    .question-number {
      color: #667eea;
      font-weight: bold;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .question-text {
      font-size: 20px;
      font-weight: 600;
      margin-top: 8px;
      line-height: 1.6;
    }

    /* Code block styling for questions with code */
    .question-text pre {
      background: #2d3748;
      color: #e2e8f0;
      padding: 16px;
      border-radius: 8px;
      overflow-x: auto;
      font-family: 'Courier New', Consolas, Monaco, monospace;
      font-size: 14px;
      line-height: 1.5;
      margin: 12px 0;
      border: 1px solid #4a5568;
      /* Prevent text selection/copying */
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
    }

    .question-text pre code {
      color: inherit;
      background: none;
      padding: 0;
    }

    .answers-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .answer-option {
      margin-bottom: 12px;
    }

    .answer-label {
      display: flex;
      align-items: center;
      padding: 16px;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }

    .answer-label:hover {
      border-color: #667eea;
      background: #f7fafc;
    }

    /* Keyboard shortcut indicator */
    .answer-label::before {
      content: attr(data-key);
      position: absolute;
      right: 12px;
      top: 12px;
      width: 24px;
      height: 24px;
      background: #e2e8f0;
      color: #718096;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: bold;
      font-family: monospace;
    }

    .answer-label:hover::before {
      background: #667eea;
      color: white;
    }

    .answer-radio {
      margin-right: 12px;
      width: 20px;
      height: 20px;
      accent-color: #667eea;
    }

    .answer-text {
      flex: 1;
      font-size: 16px;
    }

    .answer-label input:checked + .answer-indicator {
      border-color: #667eea;
      background: #667eea;
    }

    .quiz-navigation {
      padding: 24px 32px;
      border-top: 2px solid #e2e8f0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-primary {
      background: #667eea;
      color: white;
      position: relative;
      padding-right: 70px; /* Make room for Enter badge */
    }

    .btn-primary:hover:not(:disabled) {
      background: #5a67d8;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    /* Enter key indicator on Next/Submit buttons */
    #next-btn::after,
    #submit-btn::after {
      content: '‚èé';
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.2);
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 14px;
      font-weight: bold;
    }

    .btn-secondary {
      background: #e2e8f0;
      color: #2d3748;
    }

    .btn-secondary:hover:not(:disabled) {
      background: #cbd5e0;
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .btn-success {
      background: #48bb78;
      color: white;
    }

    .btn-success:hover:not(:disabled) {
      background: #38a169;
    }

    .question-navigator {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));
      gap: 8px;
      margin-top: 16px;
    }

    .nav-dot {
      width: 40px;
      height: 40px;
      border: 2px solid #e2e8f0;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.2s;
    }

    .nav-dot:hover {
      border-color: #667eea;
    }

    .nav-dot.answered {
      background: #c3dafe;
      border-color: #667eea;
    }

    .nav-dot.current {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }

    #loading, #quiz-start, #quiz-active, #quiz-results {
      display: none;
    }

    .start-screen, .results-screen {
      text-align: center;
      padding: 48px 32px;
    }

    .start-screen h1, .results-screen h1 {
      font-size: 32px;
      margin-bottom: 16px;
      color: #2d3748;
    }

    .start-screen p {
      font-size: 18px;
      color: #718096;
      margin-bottom: 32px;
    }

    .quiz-info {
      background: #f7fafc;
      padding: 24px;
      border-radius: 8px;
      margin: 24px 0;
      text-align: left;
    }

    .quiz-info ul {
      list-style: none;
      padding: 0;
    }

    .quiz-info li {
      padding: 8px 0;
      border-bottom: 1px solid #e2e8f0;
    }

    .quiz-info li:last-child {
      border-bottom: none;
    }

    .score-display {
      font-size: 72px;
      font-weight: bold;
      color: #667eea;
      margin: 24px 0;
    }

    .score-label {
      font-size: 18px;
      color: #718096;
      margin-bottom: 32px;
    }

    .error-message {
      background: #fed7d7;
      color: #c53030;
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 24px;
    }

    .success-message {
      background: #c6f6d5;
      color: #276749;
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 24px;
    }

    /* Access Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal-overlay.hidden {
      display: none;
    }

    .modal-content {
      background: white;
      padding: 40px;
      border-radius: 12px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      max-width: 500px;
      width: 90%;
    }

    .modal-content h2 {
      margin-top: 0;
      color: #2d3748;
      text-align: center;
      margin-bottom: 24px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #4a5568;
      font-weight: 600;
    }

    .form-group input {
      width: 100%;
      padding: 12px;
      border: 2px solid #e2e8f0;
      border-radius: 6px;
      font-size: 16px;
      box-sizing: border-box;
    }

    .form-group input:focus {
      outline: none;
      border-color: #667eea;
    }

    .form-group input.error {
      border-color: #fc8181;
    }

    .form-error {
      color: #c53030;
      font-size: 14px;
      margin-top: 4px;
      display: none;
    }

    .form-error.visible {
      display: block;
    }

    .modal-buttons {
      display: flex;
      gap: 12px;
      margin-top: 24px;
    }

    .modal-buttons button {
      flex: 1;
    }
  </style>
</head>
<body>
  <!-- Access Control Modal -->
  <div id="access-modal" class="modal-overlay">
    <div class="modal-content">
      <h2>üîê –î–æ—Å—Ç—ä–ø –¥–æ —Ç–µ—Å—Ç</h2>

      <form id="access-form">
        <div class="form-group">
          <label for="faculty-number">–§–∞–∫—É–ª—Ç–µ—Ç–µ–Ω –Ω–æ–º–µ—Ä:</label>
          <input
            type="text"
            id="faculty-number"
            placeholder="XXX-XXXXXX (–Ω–∞–ø—Ä. 123-456789)"
            maxlength="10"
            required
          >
          <div class="form-error" id="faculty-error">
            –ù–µ–≤–∞–ª–∏–¥–µ–Ω —Ñ–æ—Ä–º–∞—Ç! –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç XXX-XXXXXX
          </div>
        </div>

        <div class="form-group">
          <label for="test-password">–ü–∞—Ä–æ–ª–∞ –∑–∞ –¥–æ—Å—Ç—ä–ø:</label>
          <input
            type="password"
            id="test-password"
            placeholder="–í—ä–≤–µ–¥–µ—Ç–µ –ø–∞—Ä–æ–ª–∞"
            required
          >
          <div class="form-error" id="password-error">
            –ì—Ä–µ—à–Ω–∞ –ø–∞—Ä–æ–ª–∞!
          </div>
        </div>

        <div class="modal-buttons">
          <button type="submit" class="btn btn-primary btn-large">
            –í–ª–∏–∑–∞–Ω–µ
          </button>
        </div>
      </form>
    </div>
  </div>
  <div class="quiz-container">
    <!-- Loading State -->
    <div id="loading">
      <div class="start-screen">
        <h1>‚è≥ –ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –≤—ä–ø—Ä–æ—Å–∏...</h1>
        <p>–ú–æ–ª—è –∏–∑—á–∞–∫–∞–π—Ç–µ</p>
      </div>
    </div>

    <!-- Start Screen -->
    <div id="quiz-start">
      <div class="start-screen">
        <h1>üìù CS50 –¢–µ—Å—Ç</h1>
        <p>–ì–æ—Ç–æ–≤–∏ –ª–∏ —Å—Ç–µ –¥–∞ –ø–æ–∫–∞–∂–µ—Ç–µ –∑–Ω–∞–Ω–∏—è—Ç–∞ —Å–∏ –ø–æ C –ø—Ä–æ–≥—Ä–∞–º–∏—Ä–∞–Ω–µ?</p>

        <div id="error-container"></div>

        <div class="quiz-info">
          <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ —Ç–µ—Å—Ç–∞:</h3>
          <ul>
            <li>üìä <strong>–í—ä–ø—Ä–æ—Å–∏:</strong> 25 –≤—ä–ø—Ä–æ—Å–∞ (—Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä–∞–Ω–∏ –æ—Ç 225)</li>
            <li>‚è±Ô∏è <strong>–í—Ä–µ–º–µ:</strong> 25 –º–∏–Ω—É—Ç–∏</li>
            <li>üéØ <strong>–¢–æ—á–∫—É–≤–∞–Ω–µ:</strong> 1 —Ç–æ—á–∫–∞ = 1 –≤–µ—Ä–µ–Ω –æ—Ç–≥–æ–≤–æ—Ä</li>
            <li>‚ö†Ô∏è <strong>–í–∞–∂–Ω–æ:</strong> –ò–º–∞—Ç–µ –ø—Ä–∞–≤–æ –Ω–∞ –°–ê–ú–û 1 –æ–ø–∏—Ç!</li>
            <li>üíæ <strong>–†–µ–∑—É–ª—Ç–∞—Ç:</strong> –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–µ –∑–∞–ø–∞–∑–≤–∞ –≤ GitHub</li>
          </ul>
        </div>

        <button class="btn btn-primary btn-large" id="start-quiz-btn" style="font-size: 18px; padding: 16px 48px;">
          –ó–∞–ø–æ—á–Ω–∏ —Ç–µ—Å—Ç
        </button>
      </div>
    </div>

    <!-- Active Quiz -->
    <div id="quiz-active">
      <!-- Header with Timer -->
      <div class="quiz-header">
        <div>
          <h2 style="margin: 0;">CS50 –¢–µ—Å—Ç</h2>
          <span id="username-display"></span>
        </div>
        <div class="timer" id="timer">25:00</div>
      </div>

      <!-- Keyboard Shortcuts Hint -->
      <div class="keyboard-hint">
        ‚å®Ô∏è Keyboard shortcuts: <kbd>1</kbd><kbd>2</kbd><kbd>3</kbd><kbd>4</kbd> –∑–∞ –∏–∑–±–æ—Ä –Ω–∞ –æ—Ç–≥–æ–≤–æ—Ä ‚Ä¢ <kbd>Enter ‚èé</kbd> –∑–∞ —Å–ª–µ–¥–≤–∞—â –≤—ä–ø—Ä–æ—Å
      </div>

      <!-- Progress Bar -->
      <div class="quiz-progress">
        <div style="display: flex; justify-content: space-between; align-items: center;">
          <span id="progress-text">–í—ä–ø—Ä–æ—Å 1 –æ—Ç 25</span>
          <span id="answered-count">–û—Ç–≥–æ–≤–æ—Ä–µ–Ω–∏: 0/25</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
        </div>

        <!-- Question Navigator -->
        <div class="question-navigator" id="question-navigator"></div>
      </div>

      <!-- Question Content -->
      <div class="quiz-content">
        <div class="question-header">
          <div class="question-number" id="question-number">–í—ä–ø—Ä–æ—Å 1</div>
          <div class="question-text" id="question-text"></div>
        </div>

        <ul class="answers-list" id="answers-list"></ul>
      </div>

      <!-- Navigation -->
      <div class="quiz-navigation">
        <button class="btn btn-secondary" id="prev-btn">‚Üê –ü—Ä–µ–¥–∏—à–µ–Ω</button>
        <button class="btn btn-success" id="submit-btn" style="display: none;">–ü—Ä–µ–¥–∞–π —Ç–µ—Å—Ç</button>
        <button class="btn btn-primary" id="next-btn">–°–ª–µ–¥–≤–∞—â ‚Üí</button>
      </div>
    </div>

    <!-- Results Screen -->
    <div id="quiz-results">
      <div class="results-screen">
        <h1>üéâ –¢–µ—Å—Ç –∑–∞–≤—ä—Ä—à–µ–Ω!</h1>

        <div class="score-display" id="final-score">20/25</div>
        <div class="score-label" id="score-label">–í–∞—à–∏—è—Ç —Ä–µ–∑—É–ª—Ç–∞—Ç</div>

        <div id="result-message"></div>

        <div class="quiz-info">
          <h3>–î–µ—Ç–∞–π–ª–∏:</h3>
          <ul id="result-details"></ul>
        </div>

        <a href="dashboard.html" class="btn btn-primary">–ö—ä–º Dashboard</a>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="config.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/xml-parser.js"></script>
  <script src="js/quiz-manager.js"></script>
  <script src="js/quiz-storage.js"></script>
  <script src="js/quiz-app.js"></script>
</body>
</html>
