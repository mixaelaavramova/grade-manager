(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2383:()=>{},2769:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>w});var r=s(5155),a=s(2115);let n="cache";function l(e){if(!e||"object"!=typeof e)return!1;for(let t of["id","username","name","avatarUrl","assignments","completedCount","totalAssignments","progressPercentage","status"])if(!(t in e))return console.error("Missing required field: ".concat(t)),!1;if("string"!=typeof e.id||"string"!=typeof e.username||"string"!=typeof e.name||"string"!=typeof e.avatarUrl||!Array.isArray(e.assignments)||"number"!=typeof e.completedCount||"number"!=typeof e.totalAssignments||"number"!=typeof e.progressPercentage||!["passed","in_progress","failed"].includes(e.status))return!1;if(void 0!==e.lastActive&&"string"!=typeof e.lastActive)return console.error("lastActive must be ISO string, not Date object"),!1;for(let t of e.assignments)if(!t.name||"string"!=typeof t.name||!t.repoName||"string"!=typeof t.repoName||!["success","failure","in_progress","not_started","no_tests"].includes(t.status))return!1;return!0}function i(e){if(!l(e)||!Array.isArray(e.repos)||!Array.isArray(e.commitActivity))return!1;if(14!==e.commitActivity.length)return console.error("commitActivity must be array of 14 numbers"),!1;if("number"!=typeof e.totalCommits)return!1;for(let t of e.commitActivity)if("number"!=typeof t)return console.error("commitActivity must contain only numbers"),!1;return!0}function o(e){if(!Array.isArray(e))return!1;for(let t of e)if(!l(t))return!1;return!0}class c{async initDB(){if(this.dbPromise)return this.dbPromise;if("undefined"==typeof indexedDB)throw Error("IndexedDB is only available in browser");return this.dbPromise=new Promise((e,t)=>{let s=indexedDB.open("github-classroom-cache",1);s.onerror=()=>{t(Error("Failed to open IndexedDB"))},s.onsuccess=()=>{e(s.result)},s.onupgradeneeded=e=>{let t=e.target.result;t.objectStoreNames.contains(n)||t.createObjectStore(n,{keyPath:"key"})}}),this.dbPromise}async saveToCache(e,t,s){if("students"===e&&!o(t))throw Error("Invalid students array structure - data will not work with UI");if(e.startsWith("student-details-")&&!i(t))throw Error("Invalid student details structure - data will not work with UI");let r=await this.initDB(),a=Date.now(),l={key:e,data:t,timestamp:a,expiresAt:a+s};return new Promise((e,t)=>{let s=r.transaction([n],"readwrite").objectStore(n).put(l);s.onsuccess=()=>e(),s.onerror=()=>t(Error("Failed to save to cache"))})}async getFromCache(e){let t=await this.initDB();return new Promise((s,r)=>{let a=t.transaction([n],"readonly").objectStore(n).get(e);a.onsuccess=()=>{let t=a.result;if(!t)return void s(null);if(Date.now()>t.expiresAt){this.deleteFromCache(e),s(null);return}if("students"===e&&!o(t.data)){console.error("Cached students data has invalid structure, ignoring"),this.deleteFromCache(e),s(null);return}if(e.startsWith("student-details-")&&!i(t.data)){console.error("Cached student details has invalid structure, ignoring"),this.deleteFromCache(e),s(null);return}s(t.data)},a.onerror=()=>r(Error("Failed to read from cache"))})}async isCacheFresh(e,t){let s=await this.initDB();return new Promise((r,a)=>{let l=s.transaction([n],"readonly").objectStore(n).get(e);l.onsuccess=()=>{let e=l.result;if(!e)return void r(!1);let s=Date.now();r(s-e.timestamp<t&&s<e.expiresAt)},l.onerror=()=>a(Error("Failed to check cache freshness"))})}async getCacheMetadata(e){let t=await this.initDB();return new Promise((s,r)=>{let a=t.transaction([n],"readonly").objectStore(n).get(e);a.onsuccess=()=>{let e=a.result;if(!e)return void s(null);let t=Date.now();s({timestamp:e.timestamp,age:t-e.timestamp,expiresAt:e.expiresAt})},a.onerror=()=>r(Error("Failed to get cache metadata"))})}async deleteFromCache(e){let t=await this.initDB();return new Promise((s,r)=>{let a=t.transaction([n],"readwrite").objectStore(n).delete(e);a.onsuccess=()=>s(),a.onerror=()=>r(Error("Failed to delete from cache"))})}async clearCache(){let e=await this.initDB();return new Promise((t,s)=>{let r=e.transaction([n],"readwrite").objectStore(n).clear();r.onsuccess=()=>t(),r.onerror=()=>s(Error("Failed to clear cache"))})}constructor(){this.dbPromise=null}}let d=new c;async function m(){try{let e=await fetch("".concat("/nvnacs50-dashboard","/cache/metadata.json"),{cache:"no-store"});if(!e.ok)return null;return await e.json()}catch(e){return console.warn("Static cache metadata not found (GitHub Action may not have run yet)"),null}}async function u(){try{let e=await fetch("".concat("/nvnacs50-dashboard","/cache/students.json"),{cache:"no-store"});if(!e.ok)return null;let t=await e.json();if(!Array.isArray(t))return console.error("Static cache students.json is not an array"),null;return t}catch(e){return console.warn("Static cache students.json not found"),null}}async function h(){try{let[e,t]=await Promise.all([m(),u()]);if(!e||!t)return null;return{students:t,metadata:e}}catch(e){return console.error("Failed to fetch static cache:",e),null}}let g=[{name:"hello",alternativeNames:["me"]},{name:"mario-less",group:"mario"},{name:"mario-more",group:"mario"},{name:"cash",group:"cash-credit"},{name:"credit",group:"cash-credit"},{name:"scrabble"},{name:"readability"},{name:"caesar",group:"cipher"},{name:"substitution",group:"cipher"},{name:"sort"},{name:"plurality"},{name:"runoff",group:"voting"},{name:"tideman",group:"voting"},{name:"volume"},{name:"filter-less",group:"filter"},{name:"filter-more",group:"filter"},{name:"recover"},{name:"inheritance"},{name:"speller"}];class x{async batchPromises(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.CONCURRENT_REQUESTS,r=[];for(let a=0;a<e.length;a+=s){let n=e.slice(a,a+s),l=await Promise.all(n.map(t));r.push(...l)}return r}async fetchWithAuth(e){let t=await fetch(e,{headers:{Authorization:"Bearer ".concat(this.token),Accept:"application/vnd.github.v3+json"}});if(!t.ok)throw Error("GitHub API error: ".concat(t.status," ").concat(t.statusText));return t.json()}getCached(e){let t=this.cache.get(e);return t&&Date.now()-t.timestamp<this.CACHE_TTL?t.data:null}setCache(e,t){this.cache.set(e,{data:t,timestamp:Date.now()})}async getOrganizationRepos(){let e="repos-".concat(this.org),t=this.getCached(e);if(t)return t;let s=[],r=1,a=!0;for(;a;){let e="https://api.github.com/orgs/".concat(this.org,"/repos?per_page=100&page=").concat(r,"&sort=updated"),t=await this.fetchWithAuth(e);0===t.length?a=!1:(s.push(...t),r++)}let n=s.filter(e=>{let t=e.name.toLowerCase();return!t.includes("dashboard")&&!t.includes(".github")&&!t.startsWith(".")});return this.setCache(e,n),n}parseAssignmentName(e){let t=e.toLowerCase().replace(/^nvnacs50-/i,"");for(let e of[...g].sort((e,t)=>{let s=e.name.length;return t.name.length-s})){if(t.startsWith(e.name+"-")||t===e.name)return e.name;if(e.alternativeNames){for(let s of e.alternativeNames)if(t.startsWith(s+"-")||t===s)return e.name}}let s=t.split("-");if(s.length>=2)for(let e of g){var r;if(e.name===s[0]||(null==(r=e.alternativeNames)?void 0:r.includes(s[0])))return e.name}return null}extractUsernameFromRepo(e){let t=e.toLowerCase().replace(/^nvnacs50-/i,""),s=this.parseAssignmentName(e);if(!s)return null;if(t.startsWith(s+"-"))return t.substring(s.length+1);let r=g.find(e=>e.name===s);if(null==r?void 0:r.alternativeNames){for(let e of r.alternativeNames)if(t.startsWith(e+"-"))return t.substring(e.length+1)}return null}async getWorkflowStatus(e,t){try{var s;let r="https://api.github.com/repos/".concat(e,"/").concat(t,"/actions/runs?per_page=1");return(null==(s=(await this.fetchWithAuth(r)).workflow_runs)?void 0:s[0])||null}catch(e){return console.warn("Failed to fetch workflow for ".concat(t,":"),e),null}}async getLatestCommit(e,t){try{let s="https://api.github.com/repos/".concat(e,"/").concat(t,"/commits?per_page=1");return(await this.fetchWithAuth(s))[0]||null}catch(e){return console.warn("Failed to fetch commits for ".concat(t,":"),e),null}}determineStatus(e,t){return t?e?"in_progress"===e.status||"queued"===e.status?"in_progress":"success"===e.conclusion?"success":"failure":"no_tests":"not_started"}async getAllStudents(e){try{let e=await d.getFromCache("students"),t=await d.getCacheMetadata("students");if(e&&t){let s=t.age;if(s<this.INDEXEDDB_TTL)return console.log("✅ Using IndexedDB cache (".concat(Math.round(s/1e3),"s old)")),this.lastDataSource="indexeddb",this.lastSyncTimestamp=t.timestamp,e}}catch(e){console.warn("Failed to read from IndexedDB cache:",e)}try{let e=await h();if(e){let t=Date.now()-e.metadata.timestamp;if(t<this.STATIC_CACHE_MAX_AGE)return console.log("✅ Using static cache (".concat(Math.round(t/6e4)," min old)")),await d.saveToCache("students",e.students,this.INDEXEDDB_TTL),this.lastDataSource="static-cache",this.lastSyncTimestamp=e.metadata.timestamp,e.students;console.log("⚠️ Static cache is too old (".concat(Math.round(t/6e4)," min), fetching live data"))}}catch(e){console.warn("Failed to read from static cache:",e)}console.log("\uD83D\uDCE1 Fetching live data from GitHub API...");let t=await this.getAllStudentsFromAPI(e);try{await d.saveToCache("students",t,this.INDEXEDDB_TTL)}catch(e){console.warn("Failed to save to IndexedDB:",e)}return this.lastDataSource="live-api",this.lastSyncTimestamp=Date.now(),t}async forceSync(e){console.log("\uD83D\uDD04 Force syncing from GitHub API...");let t=await this.getAllStudentsFromAPI(e);try{await d.saveToCache("students",t,this.INDEXEDDB_TTL)}catch(e){console.warn("Failed to save to IndexedDB:",e)}return this.lastDataSource="live-api",this.lastSyncTimestamp=Date.now(),t}async getAllStudentsFromAPI(e){let t=await this.getOrganizationRepos(),s=new Map;for(let e of t){let t=this.extractUsernameFromRepo(e.name);t&&(s.has(t)||s.set(t,[]),s.get(t).push(e))}let r=Array.from(s.keys()),a=(await this.batchPromises(t,async e=>{let t=this.parseAssignmentName(e.name);if(!t)return null;let[s,r]=await Promise.all([this.getWorkflowStatus(this.org,e.name),this.getLatestCommit(this.org,e.name)]);return{repoName:e.name,ownerLogin:e.owner.login,assignmentName:t,workflow:s,commit:r,avatarUrl:e.owner.avatar_url}})).filter(e=>null!==e),n=[],l=0;for(let t of r){var i;let s=a.filter(e=>this.extractUsernameFromRepo(e.repoName)===t),o=s.map(e=>{var t,s,r,a,n,l,i;let o=this.determineStatus(e.workflow,e.commit);return{name:e.assignmentName,repoName:e.repoName,status:o,lastCommitDate:null==(r=e.commit)||null==(s=r.commit)||null==(t=s.author)?void 0:t.date,lastCommitMessage:null==(l=e.commit)||null==(n=l.commit)||null==(a=n.message)?void 0:a.split("\n")[0],workflowStatus:null==(i=e.workflow)?void 0:i.conclusion}}),c=o.filter(e=>"success"===e.status).length,d=Math.round(c/14*100),m="in_progress";14===c?m="passed":o.some(e=>"failure"===e.status)&&(m="failed");let u=o.map(e=>e.lastCommitDate).filter(e=>e).sort((e,t)=>new Date(t).getTime()-new Date(e).getTime())[0];n.push({id:t,username:t,name:t.charAt(0).toUpperCase()+t.slice(1),avatarUrl:(null==(i=s[0])?void 0:i.avatarUrl)||"",assignments:o,completedCount:c,totalAssignments:14,progressPercentage:d,lastActive:u,status:m}),l++,e&&e(l,r.length)}return n.sort((e,t)=>e.name.localeCompare(t.name)),n}async getStudentDetails(e){var t,s;let r=(await this.getOrganizationRepos()).filter(t=>this.extractUsernameFromRepo(t.name)===e);if(0===r.length)return null;let a=r.map(async e=>{let t=this.parseAssignmentName(e.name);if(!t)return null;let[s,r,a]=await Promise.all([this.getWorkflowStatus(this.org,e.name),this.getLatestCommit(this.org,e.name),this.fetchWithAuth("https://api.github.com/repos/".concat(this.org,"/").concat(e.name,"/commits?per_page=100")).catch(()=>[])]),n=this.determineStatus(s,r);return{assignmentName:t,repoName:e.name,status:n,workflow:s,commit:r,commits:a}}),n=(await Promise.all(a)).filter(e=>null!==e),l=n.map(e=>{var t,s,r,a,n,l,i;return{name:e.assignmentName,repoName:e.repoName,status:e.status,lastCommitDate:null==(r=e.commit)||null==(s=r.commit)||null==(t=s.author)?void 0:t.date,lastCommitMessage:null==(l=e.commit)||null==(n=l.commit)||null==(a=n.message)?void 0:a.split("\n")[0],workflowStatus:null==(i=e.workflow)?void 0:i.conclusion}}),i=l.filter(e=>"success"===e.status).length,o=Math.round(i/14*100),c="in_progress";14===i?c="passed":l.some(e=>"failure"===e.status)&&(c="failed");let d=l.map(e=>e.lastCommitDate).filter(e=>e).sort((e,t)=>new Date(t).getTime()-new Date(e).getTime())[0],m=Array(14).fill(0),u=0,h=new Date;for(let e of n){let t=e.commits;for(let e of(u+=t.length,t))try{let t=new Date(e.commit.author.date),s=Math.floor((h.getTime()-t.getTime())/864e5);s>=0&&s<14&&m[13-s]++}catch(e){}}return{id:e,username:e,name:e.charAt(0).toUpperCase()+e.slice(1),avatarUrl:(null==(s=r[0])||null==(t=s.owner)?void 0:t.avatar_url)||"",assignments:l,completedCount:i,totalAssignments:14,progressPercentage:o,lastActive:d,status:c,repos:r,commitActivity:m,totalCommits:u}}async getCacheInfo(){try{let e=await d.getCacheMetadata("students");if(e)return{hasCache:!0,source:"indexeddb",timestamp:e.timestamp,age:e.age}}catch(e){console.warn("Failed to get IndexedDB metadata:",e)}try{let e=await h();if(e)return{hasCache:!0,source:"static-cache",timestamp:e.metadata.timestamp,age:Date.now()-e.metadata.timestamp}}catch(e){console.warn("Failed to get static cache metadata:",e)}return{hasCache:!1,source:null,timestamp:null,age:null}}async clearAllCaches(){this.cache.clear(),await d.clearCache()}clearCache(){this.cache.clear()}constructor(e,t="nvnacs50"){this.CACHE_TTL=3e5,this.CONCURRENT_REQUESTS=50,this.INDEXEDDB_TTL=18e5,this.STATIC_CACHE_MAX_AGE=72e5,this.lastDataSource=null,this.lastSyncTimestamp=null,this.token=e,this.org=t,this.cache=new Map}}var f=s(6074);function p(e){let{students:t,onStudentClick:s,searchQuery:n,filterStatus:l,sortBy:i}=e,o=(0,a.useRef)(null),c=(0,a.useMemo)(()=>{let e=t;if(n){let t=n.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.username.toLowerCase().includes(t))}return"all"!==l&&(e=e.filter(e=>e.status===l)),e=[...e].sort((e,t)=>{switch(i){case"name":return e.name.localeCompare(t.name);case"progress":return t.progressPercentage-e.progressPercentage;case"lastActive":let s=e.lastActive?new Date(e.lastActive).getTime():0;return(t.lastActive?new Date(t.lastActive).getTime():0)-s;default:return 0}})},[t,n,l,i]),d=(0,f.Te)({count:c.length,getScrollElement:()=>o.current,estimateSize:()=>60,overscan:10});return 0===c.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Няма студенти"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:n||"all"!==l?"Няма студенти, които отговарят на филтрите":"Няма налични данни за студенти"})]}):(0,r.jsxs)("div",{className:"overflow-hidden bg-white shadow-sm rounded-lg border border-gray-200",children:[(0,r.jsx)("div",{className:"bg-gray-50 px-6 py-3 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"grid grid-cols-12 gap-4 text-xs font-medium text-gray-500 uppercase tracking-wider",children:[(0,r.jsx)("div",{className:"col-span-3",children:"Име"}),(0,r.jsx)("div",{className:"col-span-3",children:"Прогрес"}),(0,r.jsx)("div",{className:"col-span-2",children:"Последна активност"}),(0,r.jsx)("div",{className:"col-span-2",children:"Статус"}),(0,r.jsx)("div",{className:"col-span-2 text-right",children:"Действия"})]})}),(0,r.jsx)("div",{ref:o,className:"overflow-auto",style:{height:"600px"},children:(0,r.jsx)("div",{style:{height:"".concat(d.getTotalSize(),"px"),width:"100%",position:"relative"},children:d.getVirtualItems().map(e=>{let t=c[e.index];return(0,r.jsx)("div",{className:"absolute top-0 left-0 w-full px-6 py-4 border-b border-gray-100 hover:bg-gray-50 transition-colors cursor-pointer",style:{height:"".concat(e.size,"px"),transform:"translateY(".concat(e.start,"px)")},onClick:()=>s(t),children:(0,r.jsxs)("div",{className:"grid grid-cols-12 gap-4 items-center",children:[(0,r.jsxs)("div",{className:"col-span-3 flex items-center gap-3",children:[(0,r.jsx)("img",{src:t.avatarUrl,alt:t.name,className:"h-8 w-8 rounded-full ring-2 ring-gray-200"}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:t.name}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:["@",t.username]})]})]}),(0,r.jsxs)("div",{className:"col-span-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"h-2 rounded-full transition-all ".concat(100===t.progressPercentage?"bg-green-600":t.progressPercentage>=50?"bg-blue-600":"bg-yellow-600"),style:{width:"".concat(t.progressPercentage,"%")}})}),(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-700 min-w-[3rem] text-right",children:[t.progressPercentage,"%"]})]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[t.completedCount,"/",t.totalAssignments," завършени"]})]}),(0,r.jsx)("div",{className:"col-span-2",children:(0,r.jsx)("p",{className:"text-sm text-gray-700",children:(e=>{if(!e)return"Never";let t=new Date(e),s=new Date().getTime()-t.getTime(),r=Math.floor(s/6e4),a=Math.floor(s/36e5),n=Math.floor(s/864e5);return r<60?"".concat(r,"m ago"):a<24?"".concat(a,"h ago"):n<7?"".concat(n,"d ago"):t.toLocaleDateString("bg-BG",{month:"short",day:"numeric"})})(t.lastActive)})}),(0,r.jsx)("div",{className:"col-span-2",children:(e=>{switch(e){case"passed":return(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"✅ Passed"});case"in_progress":return(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"⏳ In Progress"});case"failed":return(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"❌ Failed"})}})(t.status)}),(0,r.jsx)("div",{className:"col-span-2 text-right",children:(0,r.jsxs)("button",{onClick:e=>{e.stopPropagation(),s(t)},className:"inline-flex items-center px-3 py-1 border border-gray-300 shadow-sm text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,r.jsxs)("svg",{className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Виж"]})})]})},t.id)})})}),(0,r.jsx)("div",{className:"bg-gray-50 px-6 py-3 border-t border-gray-200",children:(0,r.jsxs)("p",{className:"text-sm text-gray-700",children:["Показани ",(0,r.jsx)("span",{className:"font-medium",children:c.length})," от"," ",(0,r.jsx)("span",{className:"font-medium",children:t.length})," студенти"]})})]})}function b(e){let{student:t,isOpen:s,onClose:n}=e,[l,i]=(0,a.useState)("all");if((0,a.useEffect)(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[s]),!s||!t)return null;let o=t.assignments.filter(e=>"all"===l||("completed"===l?"success"===e.status:"in_progress"===l?"in_progress"===e.status||"no_tests"===e.status:"failed"!==l||"failure"===e.status)),c=t.assignments.filter(e=>"success"===e.status).length,d=t.assignments.filter(e=>"in_progress"===e.status||"no_tests"===e.status).length,m=t.assignments.filter(e=>"failure"===e.status).length,u=e=>{if(!e)return"N/A";let t=new Date(e),s=Math.floor((new Date().getTime()-t.getTime())/864e5);return 0===s?"Днес":1===s?"Вчера":s<7?"Преди ".concat(s," дни"):t.toLocaleDateString("bg-BG",{year:"numeric",month:"long",day:"numeric"})},h=Math.max(...t.commitActivity,1);return(0,r.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:n}),(0,r.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"relative w-full max-w-4xl bg-white rounded-2xl shadow-xl transform transition-all",children:[(0,r.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 px-6 py-4 border-b border-gray-200 rounded-t-2xl",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("img",{src:t.avatarUrl,alt:t.name,className:"h-16 w-16 rounded-full ring-4 ring-white"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:t.name}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["@",t.username]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:[t.totalCommits," total commits"]}),(0,r.jsx)("span",{className:"text-gray-300",children:"•"}),(0,r.jsx)("a",{href:"https://github.com/".concat(t.username),target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-700",children:"GitHub Profile →"})]})]})]}),(0,r.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-500 transition-colors",children:(0,r.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,r.jsxs)("div",{className:"px-6 py-4 bg-white border-b border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Общ прогрес"}),(0,r.jsxs)("span",{className:"text-lg font-bold text-gray-900",children:[t.completedCount,"/",t.totalAssignments," (",t.progressPercentage,"%)"]})]}),(0,r.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-3",children:(0,r.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 h-3 rounded-full transition-all",style:{width:"".concat(t.progressPercentage,"%")}})}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Последна активност: ",u(t.lastActive)]})]}),(0,r.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"\uD83D\uDCC8 Commit активност (последните 14 дни)"}),(0,r.jsx)("div",{className:"flex items-end gap-1",style:{height:"".concat(40,"px")},children:t.commitActivity.map((e,t)=>(0,r.jsx)("div",{className:"flex-1 flex flex-col items-center gap-1",children:(0,r.jsx)("div",{className:"w-full bg-blue-500 rounded-t transition-all hover:bg-blue-600",style:{height:e>0?"".concat(e/h*40,"px"):"2px",minHeight:"2px"},title:"".concat(e," commits")})},t))}),(0,r.jsxs)("div",{className:"flex justify-between mt-2",children:[(0,r.jsx)("span",{className:"text-xs text-gray-500",children:"14 дни назад"}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:"Днес"})]})]}),(0,r.jsx)("div",{className:"px-6 py-3 bg-white border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsxs)("button",{onClick:()=>i("all"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("all"===l?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"),children:["Всички (",t.assignments.length,")"]}),(0,r.jsxs)("button",{onClick:()=>i("completed"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("completed"===l?"bg-green-100 text-green-700":"text-gray-600 hover:bg-gray-100"),children:["Завършени (",c,")"]}),(0,r.jsxs)("button",{onClick:()=>i("in_progress"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("in_progress"===l?"bg-yellow-100 text-yellow-700":"text-gray-600 hover:bg-gray-100"),children:["В процес (",d,")"]}),(0,r.jsxs)("button",{onClick:()=>i("failed"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("failed"===l?"bg-red-100 text-red-700":"text-gray-600 hover:bg-gray-100"),children:["Неуспешни (",m,")"]})]})}),(0,r.jsx)("div",{className:"px-6 py-4 max-h-96 overflow-y-auto",children:(0,r.jsx)("div",{className:"space-y-3",children:0===o.length?(0,r.jsx)("p",{className:"text-center text-gray-500 py-8",children:"Няма задачи в тази категория"}):o.map((e,t)=>(0,r.jsx)("div",{className:"p-4 rounded-lg border transition-all ".concat((e=>{switch(e){case"success":return"bg-green-50 border-green-200";case"failure":return"bg-red-50 border-red-200";case"in_progress":return"bg-yellow-50 border-yellow-200";default:return"bg-gray-50 border-gray-200"}})(e.status)),children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-lg",children:(e=>{switch(e){case"success":return"✅";case"failure":return"❌";case"in_progress":return"⏳";case"no_tests":return"\uD83D\uDCCB";default:return"❓"}})(e.status)}),(0,r.jsx)("h5",{className:"font-medium text-gray-900",children:e.name})]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Repo: ",e.repoName]}),e.lastCommitMessage&&(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-2 italic",children:['"',e.lastCommitMessage,'"']})]}),(0,r.jsxs)("div",{className:"text-right ml-4",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500",children:u(e.lastCommitDate)}),(0,r.jsx)("a",{href:"https://github.com/nvnacs50/".concat(e.repoName),target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-700 mt-1 inline-block",children:"Виж →"})]})]})},t))})}),(0,r.jsx)("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 rounded-b-2xl flex justify-end",children:(0,r.jsx)("button",{onClick:n,className:"px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:"Затвори"})})]})})]})}function y(e){let{timestamp:t,source:s,onSync:n,isLoading:l}=e,[i,o]=(0,a.useState)(Date.now());(0,a.useEffect)(()=>{let e=setInterval(()=>{o(Date.now())},3e4);return()=>clearInterval(e)},[]);let c=(()=>{if(!t)return{bg:"bg-gray-50",border:"border-gray-200",text:"text-gray-700",icon:"⚪"};let e=i-t;return e<18e5?{bg:"bg-green-50",border:"border-green-200",text:"text-green-800",icon:"\uD83D\uDFE2"}:e<72e5?{bg:"bg-yellow-50",border:"border-yellow-200",text:"text-yellow-800",icon:"\uD83D\uDFE1"}:{bg:"bg-red-50",border:"border-red-200",text:"text-red-800",icon:"\uD83D\uDD34"}})();return(0,r.jsx)("div",{className:"rounded-lg border ".concat(c.border," ").concat(c.bg," px-4 py-3 mb-6 shadow-sm"),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"text-2xl",children:c.icon}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("p",{className:"text-sm font-semibold ".concat(c.text),children:(()=>{if(!t)return"Няма заредени данни";let e=i-t;return e<18e5?"Свежи данни":e<72e5?"От hourly snapshot":"Остарели данни, препоръчва се синхронизация"})()}),t&&(0,r.jsxs)("span",{className:"text-xs ".concat(c.text," opacity-75"),children:["(",(e=>{let t=Math.floor((i-e)/1e3),s=Math.floor(t/60),r=Math.floor(s/60),a=Math.floor(r/24);return t<60?"преди ".concat(t," сек"):s<60?"преди ".concat(s," мин"):r<24?"преди ".concat(r," ч"):"преди ".concat(a," д")})(t),")"]})]}),(0,r.jsxs)("p",{className:"text-xs text-gray-600 mt-0.5",children:["Източник: ",(0,r.jsx)("span",{className:"font-medium",children:(()=>{switch(s){case"indexeddb":return"IndexedDB Cache";case"static-cache":return"Static Cache (GitHub Actions)";case"live-api":return"Live API";default:return"No data"}})()}),t&&(0,r.jsxs)(r.Fragment,{children:[" ","• Последна синхронизация:"," ",new Date(t).toLocaleString("bg-BG",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]})]}),(0,r.jsxs)("button",{onClick:n,disabled:l,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[(0,r.jsx)("svg",{className:"-ml-1 mr-2 h-4 w-4 ".concat(l?"animate-spin":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),l?"Синхронизиране...":"Sync Now"]})]})})}var v=s(4246);let j=["hello","mario","cash/credit","scrabble","readability","caesar/substitution","sort","plurality","runoff/tideman","volume","filter","recover","inheritance","speller"];function w(){let[e,t]=(0,a.useState)(!1),[s,n]=(0,a.useState)(null),[l,i]=(0,a.useState)(null),[o,c]=(0,a.useState)("github"),[d,m]=(0,a.useState)([]),[u,h]=(0,a.useState)(!1),[g,f]=(0,a.useState)({current:0,total:0}),[w,N]=(0,a.useState)(null),[C,S]=(0,a.useState)(null),[k,D]=(0,a.useState)(null),[A,_]=(0,a.useState)(""),[P,L]=(0,a.useState)("all"),[E,T]=(0,a.useState)("name"),[M,I]=(0,a.useState)(null),[F,B]=(0,a.useState)(!1),[W,U]=(0,a.useState)(!1),[H,R]=(0,a.useState)(!1),[G,z]=(0,a.useState)("excel");(0,a.useEffect)(()=>{let e=localStorage.getItem("gh_token"),s=localStorage.getItem("gh_user");e&&s&&(i(e),n(JSON.parse(s)),t(!0))},[]);let O=()=>{localStorage.removeItem("gh_token"),localStorage.removeItem("gh_user"),localStorage.removeItem("gh_role"),window.location.href="/nvnacs50-dashboard/"},V=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(l){h(!0),N(null);try{let t,s=new x(l);t=e?await s.forceSync((e,t)=>{f({current:e,total:t})}):await s.getAllStudents((e,t)=>{f({current:e,total:t})}),m(t),S(s.lastSyncTimestamp),D(s.lastDataSource)}catch(e){console.error("Error loading students:",e),N(e.message||"Failed to load students from GitHub")}finally{h(!1),f({current:0,total:0})}}},[l]);(0,a.useEffect)(()=>{l&&0===d.length&&V(!1)},[l,d.length,V]);let X=async e=>{if(l){U(!0),B(!0);try{let t=new x(l),s=await t.getStudentDetails(e.username);s&&I(s)}catch(e){console.error("Error loading student details:",e)}finally{U(!1)}}},Q={total:d.length,passed:d.filter(e=>"passed"===e.status).length,inProgress:d.filter(e=>"in_progress"===e.status).length,failed:d.filter(e=>"failed"===e.status).length};return e?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("nav",{className:"bg-white border-b border-gray-200 shadow-sm",children:(0,r.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex h-16 justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"h-10 w-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-md",children:(0,r.jsx)("span",{className:"text-xl",children:"\uD83D\uDCCA"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"GitHub Classroom"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Teacher Dashboard"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[s&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("img",{src:s.avatar_url,alt:s.login,className:"h-8 w-8 rounded-full ring-2 ring-blue-500"}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:s.login})]}),(0,r.jsxs)("button",{onClick:O,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[(0,r.jsx)("svg",{className:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Изход"]})]})]})})}),(0,r.jsxs)("main",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsx)("div",{className:"mb-6 flex items-center justify-between",children:(0,r.jsxs)("div",{className:"inline-flex rounded-lg border border-gray-200 bg-white p-1",children:[(0,r.jsx)("button",{onClick:()=>c("github"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("github"===o?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"),children:"\uD83D\uDD17 GitHub API"}),(0,r.jsx)("button",{onClick:()=>c("csv"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("csv"===o?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"),children:"\uD83D\uDCC4 CSV Upload"})]})}),"github"===o?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y,{timestamp:C,source:k,onSync:()=>V(!0),isLoading:u}),(0,r.jsxs)("div",{className:"mb-6 flex flex-wrap items-center gap-4",children:[(0,r.jsx)("div",{className:"flex-1 min-w-[300px]",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,r.jsx)("input",{type:"text",value:A,onChange:e=>_(e.target.value),placeholder:"Search students...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),(0,r.jsxs)("select",{value:P,onChange:e=>L(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"all",children:"All Students"}),(0,r.jsx)("option",{value:"passed",children:"Passed Only"}),(0,r.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,r.jsx)("option",{value:"failed",children:"Failed"})]}),(0,r.jsxs)("select",{value:E,onChange:e=>T(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"name",children:"Sort by Name"}),(0,r.jsx)("option",{value:"progress",children:"Sort by Progress"}),(0,r.jsx)("option",{value:"lastActive",children:"Sort by Last Active"})]}),d.length>0&&(0,r.jsxs)("button",{onClick:()=>R(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[(0,r.jsx)("svg",{className:"-ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export"]})]}),d.length>0&&(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4 mb-6",children:[(0,r.jsx)("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg border border-gray-200",children:(0,r.jsx)("div",{className:"p-5",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"h-12 w-12 bg-blue-100 rounded-xl flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDC65"})})}),(0,r.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,r.jsxs)("dl",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Students"}),(0,r.jsx)("dd",{className:"text-3xl font-bold text-gray-900",children:Q.total})]})})]})})}),(0,r.jsx)("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg border border-gray-200",children:(0,r.jsx)("div",{className:"p-5",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"h-12 w-12 bg-green-100 rounded-xl flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-2xl",children:"✅"})})}),(0,r.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,r.jsxs)("dl",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Passed"}),(0,r.jsx)("dd",{className:"text-3xl font-bold text-green-600",children:Q.passed})]})})]})})}),(0,r.jsx)("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg border border-gray-200",children:(0,r.jsx)("div",{className:"p-5",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"h-12 w-12 bg-yellow-100 rounded-xl flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-2xl",children:"⏳"})})}),(0,r.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,r.jsxs)("dl",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"In Progress"}),(0,r.jsx)("dd",{className:"text-3xl font-bold text-yellow-600",children:Q.inProgress})]})})]})})}),(0,r.jsx)("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg border border-gray-200",children:(0,r.jsx)("div",{className:"p-5",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"h-12 w-12 bg-red-100 rounded-xl flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-2xl",children:"❌"})})}),(0,r.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,r.jsxs)("dl",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Failed"}),(0,r.jsx)("dd",{className:"text-3xl font-bold text-red-600",children:Q.failed})]})})]})})})]}),u&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[(0,r.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),(0,r.jsx)("p",{className:"text-gray-600 font-medium",children:"Loading students from GitHub..."}),g.total>0&&(0,r.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["Processing ",g.current," of ",g.total," students"]})]}),w&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,r.jsx)("div",{className:"mt-2 text-sm text-red-700",children:w})]})]})}),!u&&d.length>0&&(0,r.jsx)(p,{students:d,onStudentClick:X,searchQuery:A,filterStatus:P,sortBy:E}),!u&&0===d.length&&!w&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[(0,r.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No students loaded"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:'Click "Sync GitHub" to load students from the organization'})]})]}):(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"CSV Mode"}),(0,r.jsx)("p",{className:"text-gray-500 mt-2",children:"CSV upload functionality will be preserved from the original dashboard"})]})]}),(0,r.jsx)(b,{student:M,isOpen:F,onClose:()=>{B(!1),I(null)}}),H&&(0,r.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>R(!1)}),(0,r.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"relative w-full max-w-md bg-white rounded-2xl shadow-xl p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Export Data"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Format:"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"radio",value:"excel",checked:"excel"===G,onChange:e=>z(e.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),(0,r.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Excel (.xlsx) - Recommended"})]}),(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"radio",value:"csv",checked:"csv"===G,onChange:e=>z(e.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),(0,r.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"CSV (.csv)"})]})]})]}),(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:(0,r.jsx)("p",{className:"text-sm text-blue-800",children:"all"!==P||A?"Exporting filtered students (".concat(d.filter(e=>{if(A){let t=A.toLowerCase();if(!e.name.toLowerCase().includes(t)&&!e.username.toLowerCase().includes(t))return!1}return"all"===P||e.status===P}).length," students)"):"Exporting all students (".concat(d.length," students)")})})]}),(0,r.jsxs)("div",{className:"mt-6 flex gap-3 justify-end",children:[(0,r.jsx)("button",{onClick:()=>R(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,r.jsx)("button",{onClick:()=>{let{format:e,students:t,filename:s}={format:G,students:d.filter(e=>{if(A){let t=A.toLowerCase();if(!e.name.toLowerCase().includes(t)&&!e.username.toLowerCase().includes(t))return!1}return"all"===P||e.status===P}),includeAll:"all"===P&&!A};"excel"===e?function(e,t){let s=e.map(e=>{let t={Име:e.name,Username:e.username};return j.forEach(s=>{let r=e.assignments.find(e=>e.name.toLowerCase().includes(s.split("/")[0]));r?t[s]="success"===r.status?"✓":"failure"===r.status?"✗":"○":t[s]="-"}),t["Завършени"]="".concat(e.completedCount,"/").concat(e.totalAssignments),t["Процент"]="".concat(e.progressPercentage,"%"),t["Статус"]="passed"===e.status?"Passed":"failed"===e.status?"Failed":"In Progress",t["Последна активност"]=e.lastActive?new Date(e.lastActive).toLocaleDateString("bg-BG"):"N/A",t}),r=v.Wp.json_to_sheet(s),a=[];Object.keys(s[0]||{}).forEach((e,t)=>{let r=Math.max(e.length,...s.map(t=>String(t[e]||"").length));a[t]={wch:Math.min(Math.max(r+2,10),30)}}),r["!cols"]=a;let n=v.Wp.book_new();v.Wp.book_append_sheet(n,r,"Students");let l=[{Метрика:"Общо студенти",Стойност:e.length},{Метрика:"Passed",Стойност:e.filter(e=>"passed"===e.status).length},{Метрика:"In Progress",Стойност:e.filter(e=>"in_progress"===e.status).length},{Метрика:"Failed",Стойност:e.filter(e=>"failed"===e.status).length},{Метрика:"Средна завършеност",Стойност:Math.round(e.reduce((e,t)=>e+t.progressPercentage,0)/e.length)+"%"}],i=v.Wp.json_to_sheet(l);i["!cols"]=[{wch:25},{wch:15}],v.Wp.book_append_sheet(n,i,"Statistics");let o=t||"grades_".concat(new Date().toISOString().split("T")[0],".xlsx");v._h(n,o)}(t,s):function(e,t){let s=["Име","Username",...j,"Завършени","Процент","Статус","Последна активност"],r=e.map(e=>{let t=[e.name,e.username];return j.forEach(s=>{let r=e.assignments.find(e=>e.name.toLowerCase().includes(s.split("/")[0]));r?t.push("success"===r.status?"Pass":"failure"===r.status?"Fail":"In Progress"):t.push("Not Started")}),t.push("".concat(e.completedCount,"/").concat(e.totalAssignments)),t.push("".concat(e.progressPercentage,"%")),t.push("passed"===e.status?"Passed":"failed"===e.status?"Failed":"In Progress"),t.push(e.lastActive?new Date(e.lastActive).toLocaleDateString("bg-BG"):"N/A"),t}),a=new Blob([[s.join(","),...r.map(e=>e.map(e=>'"'.concat(String(e).replace(/"/g,'""'),'"')).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),l=URL.createObjectURL(a);n.setAttribute("href",l),n.setAttribute("download",t||"grades_".concat(new Date().toISOString().split("T")[0],".csv")),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)}(t,s),R(!1)},className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:"Download Export"})]})]})})]})]}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:(0,r.jsx)("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"mx-auto h-16 w-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg mb-4",children:(0,r.jsx)("span",{className:"text-3xl",children:"\uD83D\uDCCA"})}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"GitHub Classroom Dashboard"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"За преподаватели"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Моля, влезте отново"}),(0,r.jsx)("button",{onClick:O,className:"mt-4 w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all",children:"Вход"})]})})})}},3686:()=>{},9811:(e,t,s)=>{Promise.resolve().then(s.bind(s,2769))}},e=>{e.O(0,[524,74,441,255,358],()=>e(e.s=9811)),_N_E=e.O()}]);