(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2383:()=>{},3686:()=>{},5287:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(5155),r=s(2115);let l=[{name:"hello",alternativeNames:["me"]},{name:"mario-less",group:"mario"},{name:"mario-more",group:"mario"},{name:"cash",group:"cash-credit"},{name:"credit",group:"cash-credit"},{name:"scrabble"},{name:"readability"},{name:"caesar",group:"cipher"},{name:"substitution",group:"cipher"},{name:"sort"},{name:"plurality"},{name:"runoff",group:"voting"},{name:"tideman",group:"voting"},{name:"volume"},{name:"filter-less",group:"filter"},{name:"filter-more",group:"filter"},{name:"recover"},{name:"inheritance"},{name:"speller"}];class n{async batchPromises(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.CONCURRENT_REQUESTS,a=[];for(let r=0;r<e.length;r+=s){let l=e.slice(r,r+s),n=await Promise.all(l.map(t));a.push(...n)}return a}async fetchWithAuth(e){let t=await fetch(e,{headers:{Authorization:"Bearer ".concat(this.token),Accept:"application/vnd.github.v3+json"}});if(!t.ok)throw Error("GitHub API error: ".concat(t.status," ").concat(t.statusText));return t.json()}getCached(e){let t=this.cache.get(e);return t&&Date.now()-t.timestamp<this.CACHE_TTL?t.data:null}setCache(e,t){this.cache.set(e,{data:t,timestamp:Date.now()})}async getOrganizationRepos(){let e="repos-".concat(this.org),t=this.getCached(e);if(t)return t;let s=[],a=1,r=!0;for(;r;){let e="https://api.github.com/orgs/".concat(this.org,"/repos?per_page=100&page=").concat(a,"&sort=updated"),t=await this.fetchWithAuth(e);0===t.length?r=!1:(s.push(...t),a++)}let l=s.filter(e=>{let t=e.name.toLowerCase();return!t.includes("dashboard")&&!t.includes(".github")&&!t.startsWith(".")});return this.setCache(e,l),l}parseAssignmentName(e){let t=e.toLowerCase().replace(/^nvnacs50-/i,"");for(let e of[...l].sort((e,t)=>{let s=e.name.length;return t.name.length-s})){if(t.startsWith(e.name+"-")||t===e.name)return e.name;if(e.alternativeNames){for(let s of e.alternativeNames)if(t.startsWith(s+"-")||t===s)return e.name}}let s=t.split("-");if(s.length>=2)for(let e of l){var a;if(e.name===s[0]||(null==(a=e.alternativeNames)?void 0:a.includes(s[0])))return e.name}return null}extractUsernameFromRepo(e){let t=e.toLowerCase().replace(/^nvnacs50-/i,""),s=this.parseAssignmentName(e);if(!s)return null;if(t.startsWith(s+"-"))return t.substring(s.length+1);let a=l.find(e=>e.name===s);if(null==a?void 0:a.alternativeNames){for(let e of a.alternativeNames)if(t.startsWith(e+"-"))return t.substring(e.length+1)}return null}async getWorkflowStatus(e,t){try{var s;let a="https://api.github.com/repos/".concat(e,"/").concat(t,"/actions/runs?per_page=1");return(null==(s=(await this.fetchWithAuth(a)).workflow_runs)?void 0:s[0])||null}catch(e){return console.warn("Failed to fetch workflow for ".concat(t,":"),e),null}}async getLatestCommit(e,t){try{let s="https://api.github.com/repos/".concat(e,"/").concat(t,"/commits?per_page=1");return(await this.fetchWithAuth(s))[0]||null}catch(e){return console.warn("Failed to fetch commits for ".concat(t,":"),e),null}}determineStatus(e,t){return t?e?"in_progress"===e.status||"queued"===e.status?"in_progress":"success"===e.conclusion?"success":"failure":"no_tests":"not_started"}async getAllStudents(e){let t=await this.getOrganizationRepos(),s=new Map;for(let e of t){let t=this.extractUsernameFromRepo(e.name);t&&(s.has(t)||s.set(t,[]),s.get(t).push(e))}let a=Array.from(s.keys()),r=(await this.batchPromises(t,async e=>{let t=this.parseAssignmentName(e.name);if(!t)return null;let[s,a]=await Promise.all([this.getWorkflowStatus(this.org,e.name),this.getLatestCommit(this.org,e.name)]);return{repoName:e.name,ownerLogin:e.owner.login,assignmentName:t,workflow:s,commit:a,avatarUrl:e.owner.avatar_url}})).filter(e=>null!==e),l=[],n=0;for(let t of a){var i;let s=r.filter(e=>this.extractUsernameFromRepo(e.repoName)===t),o=s.map(e=>{var t,s,a,r,l,n,i;let o=this.determineStatus(e.workflow,e.commit);return{name:e.assignmentName,repoName:e.repoName,status:o,lastCommitDate:null==(a=e.commit)||null==(s=a.commit)||null==(t=s.author)?void 0:t.date,lastCommitMessage:null==(n=e.commit)||null==(l=n.commit)||null==(r=l.message)?void 0:r.split("\n")[0],workflowStatus:null==(i=e.workflow)?void 0:i.conclusion}}),c=o.filter(e=>"success"===e.status).length,d=Math.round(c/14*100),m="in_progress";14===c?m="passed":o.some(e=>"failure"===e.status)&&(m="failed");let u=o.map(e=>e.lastCommitDate).filter(e=>e).sort((e,t)=>new Date(t).getTime()-new Date(e).getTime())[0];l.push({id:t,username:t,name:t.charAt(0).toUpperCase()+t.slice(1),avatarUrl:(null==(i=s[0])?void 0:i.avatarUrl)||"",assignments:o,completedCount:c,totalAssignments:14,progressPercentage:d,lastActive:u,status:m}),n++,e&&e(n,a.length)}return l.sort((e,t)=>e.name.localeCompare(t.name)),l}async getStudentDetails(e){var t,s,a,r,l,n;let i=(await this.getOrganizationRepos()).filter(t=>this.extractUsernameFromRepo(t.name)===e);if(0===i.length)return null;let o=[];for(let e of i){let t=this.parseAssignmentName(e.name);if(!t)continue;let[s,i]=await Promise.all([this.getWorkflowStatus(this.org,e.name),this.getLatestCommit(this.org,e.name)]),c=this.determineStatus(s,i);o.push({name:t,repoName:e.name,status:c,lastCommitDate:null==i||null==(r=i.commit)||null==(a=r.author)?void 0:a.date,lastCommitMessage:null==i||null==(n=i.commit)||null==(l=n.message)?void 0:l.split("\n")[0],workflowStatus:null==s?void 0:s.conclusion})}let c=o.filter(e=>"success"===e.status).length,d=Math.round(c/14*100),m="in_progress";14===c?m="passed":o.some(e=>"failure"===e.status)&&(m="failed");let u=o.map(e=>e.lastCommitDate).filter(e=>e).sort((e,t)=>new Date(t).getTime()-new Date(e).getTime())[0],h=Array(14).fill(0),x=0;for(let e of i)try{let t=await this.fetchWithAuth("https://api.github.com/repos/".concat(this.org,"/").concat(e.name,"/commits?per_page=100"));x+=t.length;let s=new Date;for(let e of t){let t=new Date(e.commit.author.date),a=Math.floor((s.getTime()-t.getTime())/864e5);a>=0&&a<14&&h[13-a]++}}catch(t){console.warn("Failed to fetch commits for ".concat(e.name))}return{id:e,username:e,name:e.charAt(0).toUpperCase()+e.slice(1),avatarUrl:(null==(s=i[0])||null==(t=s.owner)?void 0:t.avatar_url)||"",assignments:o,completedCount:c,totalAssignments:14,progressPercentage:d,lastActive:u,status:m,repos:i,commitActivity:h,totalCommits:x}}clearCache(){this.cache.clear()}constructor(e,t="nvnacs50"){this.CACHE_TTL=3e5,this.CONCURRENT_REQUESTS=50,this.token=e,this.org=t,this.cache=new Map}}var i=s(6074);function o(e){let{students:t,onStudentClick:s,searchQuery:l,filterStatus:n,sortBy:o}=e,c=(0,r.useRef)(null),d=(0,r.useMemo)(()=>{let e=t;if(l){let t=l.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.username.toLowerCase().includes(t))}return"all"!==n&&(e=e.filter(e=>e.status===n)),e=[...e].sort((e,t)=>{switch(o){case"name":return e.name.localeCompare(t.name);case"progress":return t.progressPercentage-e.progressPercentage;case"lastActive":let s=e.lastActive?new Date(e.lastActive).getTime():0;return(t.lastActive?new Date(t.lastActive).getTime():0)-s;default:return 0}})},[t,l,n,o]),m=(0,i.Te)({count:d.length,getScrollElement:()=>c.current,estimateSize:()=>60,overscan:10});return 0===d.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Няма студенти"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:l||"all"!==n?"Няма студенти, които отговарят на филтрите":"Няма налични данни за студенти"})]}):(0,a.jsxs)("div",{className:"overflow-hidden bg-white shadow-sm rounded-lg border border-gray-200",children:[(0,a.jsx)("div",{className:"bg-gray-50 px-6 py-3 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-4 text-xs font-medium text-gray-500 uppercase tracking-wider",children:[(0,a.jsx)("div",{className:"col-span-3",children:"Име"}),(0,a.jsx)("div",{className:"col-span-3",children:"Прогрес"}),(0,a.jsx)("div",{className:"col-span-2",children:"Последна активност"}),(0,a.jsx)("div",{className:"col-span-2",children:"Статус"}),(0,a.jsx)("div",{className:"col-span-2 text-right",children:"Действия"})]})}),(0,a.jsx)("div",{ref:c,className:"overflow-auto",style:{height:"600px"},children:(0,a.jsx)("div",{style:{height:"".concat(m.getTotalSize(),"px"),width:"100%",position:"relative"},children:m.getVirtualItems().map(e=>{let t=d[e.index];return(0,a.jsx)("div",{className:"absolute top-0 left-0 w-full px-6 py-4 border-b border-gray-100 hover:bg-gray-50 transition-colors cursor-pointer",style:{height:"".concat(e.size,"px"),transform:"translateY(".concat(e.start,"px)")},onClick:()=>s(t),children:(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-4 items-center",children:[(0,a.jsxs)("div",{className:"col-span-3 flex items-center gap-3",children:[(0,a.jsx)("img",{src:t.avatarUrl,alt:t.name,className:"h-8 w-8 rounded-full ring-2 ring-gray-200"}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:t.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:["@",t.username]})]})]}),(0,a.jsxs)("div",{className:"col-span-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full transition-all ".concat(100===t.progressPercentage?"bg-green-600":t.progressPercentage>=50?"bg-blue-600":"bg-yellow-600"),style:{width:"".concat(t.progressPercentage,"%")}})}),(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-700 min-w-[3rem] text-right",children:[t.progressPercentage,"%"]})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[t.completedCount,"/",t.totalAssignments," завършени"]})]}),(0,a.jsx)("div",{className:"col-span-2",children:(0,a.jsx)("p",{className:"text-sm text-gray-700",children:(e=>{if(!e)return"Never";let t=new Date(e),s=new Date().getTime()-t.getTime(),a=Math.floor(s/6e4),r=Math.floor(s/36e5),l=Math.floor(s/864e5);return a<60?"".concat(a,"m ago"):r<24?"".concat(r,"h ago"):l<7?"".concat(l,"d ago"):t.toLocaleDateString("bg-BG",{month:"short",day:"numeric"})})(t.lastActive)})}),(0,a.jsx)("div",{className:"col-span-2",children:(e=>{switch(e){case"passed":return(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"✅ Passed"});case"in_progress":return(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"⏳ In Progress"});case"failed":return(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"❌ Failed"})}})(t.status)}),(0,a.jsx)("div",{className:"col-span-2 text-right",children:(0,a.jsxs)("button",{onClick:e=>{e.stopPropagation(),s(t)},className:"inline-flex items-center px-3 py-1 border border-gray-300 shadow-sm text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,a.jsxs)("svg",{className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Виж"]})})]})},t.id)})})}),(0,a.jsx)("div",{className:"bg-gray-50 px-6 py-3 border-t border-gray-200",children:(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:["Показани ",(0,a.jsx)("span",{className:"font-medium",children:d.length})," от"," ",(0,a.jsx)("span",{className:"font-medium",children:t.length})," студенти"]})})]})}function c(e){let{student:t,isOpen:s,onClose:l}=e,[n,i]=(0,r.useState)("all");if((0,r.useEffect)(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[s]),!s||!t)return null;let o=t.assignments.filter(e=>"all"===n||("completed"===n?"success"===e.status:"in_progress"===n?"in_progress"===e.status||"no_tests"===e.status:"failed"!==n||"failure"===e.status)),c=t.assignments.filter(e=>"success"===e.status).length,d=t.assignments.filter(e=>"in_progress"===e.status||"no_tests"===e.status).length,m=t.assignments.filter(e=>"failure"===e.status).length,u=e=>{if(!e)return"N/A";let t=new Date(e),s=Math.floor((new Date().getTime()-t.getTime())/864e5);return 0===s?"Днес":1===s?"Вчера":s<7?"Преди ".concat(s," дни"):t.toLocaleDateString("bg-BG",{year:"numeric",month:"long",day:"numeric"})},h=Math.max(...t.commitActivity,1);return(0,a.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:l}),(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"relative w-full max-w-4xl bg-white rounded-2xl shadow-xl transform transition-all",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 px-6 py-4 border-b border-gray-200 rounded-t-2xl",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("img",{src:t.avatarUrl,alt:t.name,className:"h-16 w-16 rounded-full ring-4 ring-white"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:t.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["@",t.username]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:[t.totalCommits," total commits"]}),(0,a.jsx)("span",{className:"text-gray-300",children:"•"}),(0,a.jsx)("a",{href:"https://github.com/".concat(t.username),target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-700",children:"GitHub Profile →"})]})]})]}),(0,a.jsx)("button",{onClick:l,className:"text-gray-400 hover:text-gray-500 transition-colors",children:(0,a.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,a.jsxs)("div",{className:"px-6 py-4 bg-white border-b border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Общ прогрес"}),(0,a.jsxs)("span",{className:"text-lg font-bold text-gray-900",children:[t.completedCount,"/",t.totalAssignments," (",t.progressPercentage,"%)"]})]}),(0,a.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-3",children:(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 h-3 rounded-full transition-all",style:{width:"".concat(t.progressPercentage,"%")}})}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Последна активност: ",u(t.lastActive)]})]}),(0,a.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"\uD83D\uDCC8 Commit активност (последните 14 дни)"}),(0,a.jsx)("div",{className:"flex items-end gap-1",style:{height:"".concat(40,"px")},children:t.commitActivity.map((e,t)=>(0,a.jsx)("div",{className:"flex-1 flex flex-col items-center gap-1",children:(0,a.jsx)("div",{className:"w-full bg-blue-500 rounded-t transition-all hover:bg-blue-600",style:{height:e>0?"".concat(e/h*40,"px"):"2px",minHeight:"2px"},title:"".concat(e," commits")})},t))}),(0,a.jsxs)("div",{className:"flex justify-between mt-2",children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"14 дни назад"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"Днес"})]})]}),(0,a.jsx)("div",{className:"px-6 py-3 bg-white border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsxs)("button",{onClick:()=>i("all"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("all"===n?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"),children:["Всички (",t.assignments.length,")"]}),(0,a.jsxs)("button",{onClick:()=>i("completed"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("completed"===n?"bg-green-100 text-green-700":"text-gray-600 hover:bg-gray-100"),children:["Завършени (",c,")"]}),(0,a.jsxs)("button",{onClick:()=>i("in_progress"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("in_progress"===n?"bg-yellow-100 text-yellow-700":"text-gray-600 hover:bg-gray-100"),children:["В процес (",d,")"]}),(0,a.jsxs)("button",{onClick:()=>i("failed"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("failed"===n?"bg-red-100 text-red-700":"text-gray-600 hover:bg-gray-100"),children:["Неуспешни (",m,")"]})]})}),(0,a.jsx)("div",{className:"px-6 py-4 max-h-96 overflow-y-auto",children:(0,a.jsx)("div",{className:"space-y-3",children:0===o.length?(0,a.jsx)("p",{className:"text-center text-gray-500 py-8",children:"Няма задачи в тази категория"}):o.map((e,t)=>(0,a.jsx)("div",{className:"p-4 rounded-lg border transition-all ".concat((e=>{switch(e){case"success":return"bg-green-50 border-green-200";case"failure":return"bg-red-50 border-red-200";case"in_progress":return"bg-yellow-50 border-yellow-200";default:return"bg-gray-50 border-gray-200"}})(e.status)),children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg",children:(e=>{switch(e){case"success":return"✅";case"failure":return"❌";case"in_progress":return"⏳";case"no_tests":return"\uD83D\uDCCB";default:return"❓"}})(e.status)}),(0,a.jsx)("h5",{className:"font-medium text-gray-900",children:e.name})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Repo: ",e.repoName]}),e.lastCommitMessage&&(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-2 italic",children:['"',e.lastCommitMessage,'"']})]}),(0,a.jsxs)("div",{className:"text-right ml-4",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:u(e.lastCommitDate)}),(0,a.jsx)("a",{href:"https://github.com/nvnacs50/".concat(e.repoName),target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-700 mt-1 inline-block",children:"Виж →"})]})]})},t))})}),(0,a.jsx)("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 rounded-b-2xl flex justify-end",children:(0,a.jsx)("button",{onClick:l,className:"px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:"Затвори"})})]})})]})}var d=s(4246);let m=["hello","mario","cash/credit","scrabble","readability","caesar/substitution","sort","plurality","runoff/tideman","volume","filter","recover","inheritance","speller"];function u(){let[e,t]=(0,r.useState)(!1),[s,l]=(0,r.useState)(null),[i,u]=(0,r.useState)(null),[h,x]=(0,r.useState)("github"),[g,p]=(0,r.useState)([]),[f,b]=(0,r.useState)(!1),[v,j]=(0,r.useState)({current:0,total:0}),[y,N]=(0,r.useState)(null),[w,C]=(0,r.useState)(""),[k,S]=(0,r.useState)("all"),[_,A]=(0,r.useState)("name"),[D,L]=(0,r.useState)(null),[P,M]=(0,r.useState)(!1),[E,T]=(0,r.useState)(!1),[W,H]=(0,r.useState)(!1),[U,R]=(0,r.useState)("excel");(0,r.useEffect)(()=>{let e=localStorage.getItem("gh_token"),s=localStorage.getItem("gh_user");e&&s&&(u(e),l(JSON.parse(s)),t(!0))},[]);let z=()=>{localStorage.removeItem("gh_token"),localStorage.removeItem("gh_user"),localStorage.removeItem("gh_role"),window.location.href="/nvnacs50-dashboard/"},F=(0,r.useCallback)(async()=>{if(i){b(!0),N(null);try{let e=new n(i),t=await e.getAllStudents((e,t)=>{j({current:e,total:t})});p(t)}catch(e){console.error("Error loading students:",e),N(e.message||"Failed to load students from GitHub")}finally{b(!1),j({current:0,total:0})}}},[i]),I=async e=>{if(i){T(!0),M(!0);try{let t=new n(i),s=await t.getStudentDetails(e.username);s&&L(s)}catch(e){console.error("Error loading student details:",e)}finally{T(!1)}}},B={total:g.length,passed:g.filter(e=>"passed"===e.status).length,inProgress:g.filter(e=>"in_progress"===e.status).length,failed:g.filter(e=>"failed"===e.status).length};return e?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("nav",{className:"bg-white border-b border-gray-200 shadow-sm",children:(0,a.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex h-16 justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"h-10 w-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-md",children:(0,a.jsx)("span",{className:"text-xl",children:"\uD83D\uDCCA"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"GitHub Classroom"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Teacher Dashboard"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[s&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("img",{src:s.avatar_url,alt:s.login,className:"h-8 w-8 rounded-full ring-2 ring-blue-500"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:s.login})]}),(0,a.jsxs)("button",{onClick:z,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[(0,a.jsx)("svg",{className:"-ml-1 mr-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Изход"]})]})]})})}),(0,a.jsxs)("main",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)("div",{className:"mb-6 flex items-center justify-between",children:(0,a.jsxs)("div",{className:"inline-flex rounded-lg border border-gray-200 bg-white p-1",children:[(0,a.jsx)("button",{onClick:()=>x("github"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("github"===h?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"),children:"\uD83D\uDD17 GitHub API"}),(0,a.jsx)("button",{onClick:()=>x("csv"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("csv"===h?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"),children:"\uD83D\uDCC4 CSV Upload"})]})}),"github"===h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-6 flex flex-wrap items-center gap-4",children:[(0,a.jsx)("div",{className:"flex-1 min-w-[300px]",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,a.jsx)("input",{type:"text",value:w,onChange:e=>C(e.target.value),placeholder:"Search students...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})]})}),(0,a.jsxs)("select",{value:k,onChange:e=>S(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"All Students"}),(0,a.jsx)("option",{value:"passed",children:"Passed Only"}),(0,a.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,a.jsx)("option",{value:"failed",children:"Failed"})]}),(0,a.jsxs)("select",{value:_,onChange:e=>A(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"name",children:"Sort by Name"}),(0,a.jsx)("option",{value:"progress",children:"Sort by Progress"}),(0,a.jsx)("option",{value:"lastActive",children:"Sort by Last Active"})]}),(0,a.jsxs)("button",{onClick:F,disabled:f,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[(0,a.jsx)("svg",{className:"-ml-1 mr-2 h-4 w-4 ".concat(f?"animate-spin":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),f?"Loading...":"Sync GitHub"]}),g.length>0&&(0,a.jsxs)("button",{onClick:()=>H(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[(0,a.jsx)("svg",{className:"-ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export"]})]}),g.length>0&&(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4 mb-6",children:[(0,a.jsx)("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg border border-gray-200",children:(0,a.jsx)("div",{className:"p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"h-12 w-12 bg-blue-100 rounded-xl flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDC65"})})}),(0,a.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Students"}),(0,a.jsx)("dd",{className:"text-3xl font-bold text-gray-900",children:B.total})]})})]})})}),(0,a.jsx)("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg border border-gray-200",children:(0,a.jsx)("div",{className:"p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"h-12 w-12 bg-green-100 rounded-xl flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-2xl",children:"✅"})})}),(0,a.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Passed"}),(0,a.jsx)("dd",{className:"text-3xl font-bold text-green-600",children:B.passed})]})})]})})}),(0,a.jsx)("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg border border-gray-200",children:(0,a.jsx)("div",{className:"p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"h-12 w-12 bg-yellow-100 rounded-xl flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-2xl",children:"⏳"})})}),(0,a.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"In Progress"}),(0,a.jsx)("dd",{className:"text-3xl font-bold text-yellow-600",children:B.inProgress})]})})]})})}),(0,a.jsx)("div",{className:"bg-white overflow-hidden shadow-sm rounded-lg border border-gray-200",children:(0,a.jsx)("div",{className:"p-5",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"h-12 w-12 bg-red-100 rounded-xl flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-2xl",children:"❌"})})}),(0,a.jsx)("div",{className:"ml-5 w-0 flex-1",children:(0,a.jsxs)("dl",{children:[(0,a.jsx)("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Failed"}),(0,a.jsx)("dd",{className:"text-3xl font-bold text-red-600",children:B.failed})]})})]})})})]}),f&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[(0,a.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),(0,a.jsx)("p",{className:"text-gray-600 font-medium",children:"Loading students from GitHub..."}),v.total>0&&(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["Processing ",v.current," of ",v.total," students"]})]}),y&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,a.jsx)("div",{className:"mt-2 text-sm text-red-700",children:y})]})]})}),!f&&g.length>0&&(0,a.jsx)(o,{students:g,onStudentClick:I,searchQuery:w,filterStatus:k,sortBy:_}),!f&&0===g.length&&!y&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No students loaded"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:'Click "Sync GitHub" to load students from the organization'})]})]}):(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"CSV Mode"}),(0,a.jsx)("p",{className:"text-gray-500 mt-2",children:"CSV upload functionality will be preserved from the original dashboard"})]})]}),(0,a.jsx)(c,{student:D,isOpen:P,onClose:()=>{M(!1),L(null)}}),W&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>H(!1)}),(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"relative w-full max-w-md bg-white rounded-2xl shadow-xl p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Export Data"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Format:"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",value:"excel",checked:"excel"===U,onChange:e=>R(e.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Excel (.xlsx) - Recommended"})]}),(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"radio",value:"csv",checked:"csv"===U,onChange:e=>R(e.target.value),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"CSV (.csv)"})]})]})]}),(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:(0,a.jsx)("p",{className:"text-sm text-blue-800",children:"all"!==k||w?"Exporting filtered students (".concat(g.filter(e=>{if(w){let t=w.toLowerCase();if(!e.name.toLowerCase().includes(t)&&!e.username.toLowerCase().includes(t))return!1}return"all"===k||e.status===k}).length," students)"):"Exporting all students (".concat(g.length," students)")})})]}),(0,a.jsxs)("div",{className:"mt-6 flex gap-3 justify-end",children:[(0,a.jsx)("button",{onClick:()=>H(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>{let{format:e,students:t,filename:s}={format:U,students:g.filter(e=>{if(w){let t=w.toLowerCase();if(!e.name.toLowerCase().includes(t)&&!e.username.toLowerCase().includes(t))return!1}return"all"===k||e.status===k}),includeAll:"all"===k&&!w};"excel"===e?function(e,t){let s=e.map(e=>{let t={Име:e.name,Username:e.username};return m.forEach(s=>{let a=e.assignments.find(e=>e.name.toLowerCase().includes(s.split("/")[0]));a?t[s]="success"===a.status?"✓":"failure"===a.status?"✗":"○":t[s]="-"}),t["Завършени"]="".concat(e.completedCount,"/").concat(e.totalAssignments),t["Процент"]="".concat(e.progressPercentage,"%"),t["Статус"]="passed"===e.status?"Passed":"failed"===e.status?"Failed":"In Progress",t["Последна активност"]=e.lastActive?new Date(e.lastActive).toLocaleDateString("bg-BG"):"N/A",t}),a=d.Wp.json_to_sheet(s),r=[];Object.keys(s[0]||{}).forEach((e,t)=>{let a=Math.max(e.length,...s.map(t=>String(t[e]||"").length));r[t]={wch:Math.min(Math.max(a+2,10),30)}}),a["!cols"]=r;let l=d.Wp.book_new();d.Wp.book_append_sheet(l,a,"Students");let n=[{Метрика:"Общо студенти",Стойност:e.length},{Метрика:"Passed",Стойност:e.filter(e=>"passed"===e.status).length},{Метрика:"In Progress",Стойност:e.filter(e=>"in_progress"===e.status).length},{Метрика:"Failed",Стойност:e.filter(e=>"failed"===e.status).length},{Метрика:"Средна завършеност",Стойност:Math.round(e.reduce((e,t)=>e+t.progressPercentage,0)/e.length)+"%"}],i=d.Wp.json_to_sheet(n);i["!cols"]=[{wch:25},{wch:15}],d.Wp.book_append_sheet(l,i,"Statistics");let o=t||"grades_".concat(new Date().toISOString().split("T")[0],".xlsx");d._h(l,o)}(t,s):function(e,t){let s=["Име","Username",...m,"Завършени","Процент","Статус","Последна активност"],a=e.map(e=>{let t=[e.name,e.username];return m.forEach(s=>{let a=e.assignments.find(e=>e.name.toLowerCase().includes(s.split("/")[0]));a?t.push("success"===a.status?"Pass":"failure"===a.status?"Fail":"In Progress"):t.push("Not Started")}),t.push("".concat(e.completedCount,"/").concat(e.totalAssignments)),t.push("".concat(e.progressPercentage,"%")),t.push("passed"===e.status?"Passed":"failed"===e.status?"Failed":"In Progress"),t.push(e.lastActive?new Date(e.lastActive).toLocaleDateString("bg-BG"):"N/A"),t}),r=new Blob([[s.join(","),...a.map(e=>e.map(e=>'"'.concat(String(e).replace(/"/g,'""'),'"')).join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a"),n=URL.createObjectURL(r);l.setAttribute("href",n),l.setAttribute("download",t||"grades_".concat(new Date().toISOString().split("T")[0],".csv")),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)}(t,s),H(!1)},className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:"Download Export"})]})]})})]})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"mx-auto h-16 w-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg mb-4",children:(0,a.jsx)("span",{className:"text-3xl",children:"\uD83D\uDCCA"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"GitHub Classroom Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"За преподаватели"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Моля, влезте отново"}),(0,a.jsx)("button",{onClick:z,className:"mt-4 w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all",children:"Вход"})]})})})}},9811:(e,t,s)=>{Promise.resolve().then(s.bind(s,5287))}},e=>{e.O(0,[524,74,441,255,358],()=>e(e.s=9811)),_N_E=e.O()}]);